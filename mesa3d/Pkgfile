# Description: Mesa 3D Graphics Library
# URL: http://www.mesa3d.org
# Maintainer: CRUX Xorg Team, xorg-ports at crux dot nu
# Arch Maintainer: CRUX-ARM System Team, devel at crux-arm dot nu
# Depends on: elfutils expat libdrm libvdpau llvm xorg-dri3proto xorg-glproto xorg-libxdamage xorg-libxshmfence xorg-libxvmc xorg-presentproto xorg-libxxf86vm
# Optional: nettle

name=mesa3d
version=17.1.9
release=1
source=(ftp://ftp.freedesktop.org/pub/mesa/mesa-$version.tar.xz)

build() {
  cd mesa-$version

  ./configure --prefix=/usr \
              --build=aarch64-unknown-linux-gnueabi \
              --sysconfdir=/etc \
              --disable-gallium-llvm \
              --enable-gbm \
              --enable-gles1 \
              --enable-gles2 \
              --enable-glx-tls \
              --enable-osmesa \
              --enable-texture-float \
              --enable-xa \
              --enable-llvm-shared-libs \
              --disable-dependency-tracking \
              --with-dri-drivers=swrast \
              --with-gallium-drivers=swrast,svga,freedreno \
              --with-egl-platforms=x11,drm

  make
  make DESTDIR=$PKG install
}
